<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Identifiers · CitableBase.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><script src="../../copy.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">CitableBase.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Identifiers</a><ul class="internal"><li><a class="tocitem" href="#Defining-the-Isbn10Urn-type"><span>Defining the <code>Isbn10Urn</code> type</span></a></li><li><a class="tocitem" href="#Defining-the-UrnComparisonTrait"><span>Defining the <code>UrnComparisonTrait</code></span></a></li><li><a class="tocitem" href="#Implementing-the-logic-of-URN-comparison"><span>Implementing the logic of URN comparison</span></a></li><li><a class="tocitem" href="#Optional-methods"><span>Optional methods</span></a></li><li><a class="tocitem" href="#Recap:-identifiers"><span>Recap: identifiers</span></a></li></ul></li><li><a class="tocitem" href="../citable/">Citable objects</a></li><li><a class="tocitem" href="../collections/">Citable collections</a></li><li><a class="tocitem" href="../collections2/">Julia collections</a></li><li><a class="tocitem" href="../apis/">API documentation</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Identifiers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Identifiers</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/cite-architecture/CitableBase.jl/blob/master/docs/src/urns.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Identification-with-URNs"><a class="docs-heading-anchor" href="#Identification-with-URNs">Identification with URNs</a><a id="Identification-with-URNs-1"></a><a class="docs-heading-anchor-permalink" href="#Identification-with-URNs" title="Permalink"></a></h1><blockquote><h2>Summary</h2><p><strong>The task</strong>: ISBN numbers uniquely identify published editions of a book.  We want to create a type representing a 10-digit ISBN number, and be able to compare ISBN numbers using URN logic.</p><p><strong>The implementation</strong>:</p><ul><li>define a new URN type representing an ISBN-10 number</li><li>implement the <code>UrnComparisonTrait</code> for the new type</li></ul></blockquote><h2 id="Defining-the-Isbn10Urn-type"><a class="docs-heading-anchor" href="#Defining-the-Isbn10Urn-type">Defining the <code>Isbn10Urn</code> type</a><a id="Defining-the-Isbn10Urn-type-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-Isbn10Urn-type" title="Permalink"></a></h2><p>The <code>Urn</code> abstract type models a Uniform Resource Name (URN). We&#39;ll follow  the requirements of the URN standard to create a URN type for ISBN-10 numbers.  Its URN strings will have three colon-delimited components, beginning with the required prefix <code>urn</code>, then a URN type we&#39;ll call <code>isbn10</code>, followed by a 10-digit ISBN number.  For example, the URN for <em>Distant Horizons</em> by Ted Underwood will be <code>urn:isbn10:022661283X</code>. (Yes, the last &quot;digit&quot; of an ISBN number can be <code>X</code>.)</p><p>We will make the new type a subtype of <code>Urn</code>, so that we can use it freely with other packages that recognize URNs.</p><pre><code class="language-julia hljs">using CitableBase
struct Isbn10Urn &lt;: Urn
    isbn::AbstractString
end</code></pre><div class="admonition is-warning"><header class="admonition-header">Note on the ISBN format and our `Isbn10Urn` type</header><div class="admonition-body"><p>There is in fact a URN namespace for ISBN numbers identifeid by the <code>isbn</code> namespace identifier. (See this <a href="https://www.benmeadowcroft.com/webdev/articles/urns-and-citations/">blogpost about citing publications with URNs</a>.)  This guide invents an <code>isbn10</code> URN type solely to illustrate how you could create your own URN type using the <code>CitableBase</code> package.</p><p>Parsing the full <a href="https://en.wikipedia.org/wiki/International_Standard_Book_Number">ISBN-10 format</a> is extremely complicated: ISBN-10 numbers have four components, each of which is variable in length! In this user&#39;s guide example, we&#39;ll restrict ourselves to ISBNs for books published in English-, French- or German-speaking countries, indicated by an initial digit of <code>0</code> or <code>1</code> (English), <code>2</code> (French) or <code>3</code> (German).  In a real program, we would enforce this in the constructor, but to keep our example brief and focused on the <code>CitableBase</code> class, we blindly accept any string value for the <code>isbn</code> field of our type.</p></div></div><p>Our new type is a subtype of <code>Urn</code>.</p><pre><code class="language-julia hljs">supertype(Isbn10Urn)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Urn</code></pre><p>As often in Julia, we&#39;ll override the default <code>show</code> method for our type.  (Note that in Julia this requires <em>importing</em> the specific method, not just using the package.)</p><pre><code class="language-julia hljs">import Base: show
function show(io::IO, u::Isbn10Urn)
    print(io, u.isbn)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">show (generic function with 295 methods)</code></pre><p>Now when we create objects of our new type, the display in our REPL (or other contexts) will be easily recognizable as an <code>Isbn10Urn</code>.</p><pre><code class="language-julia hljs">distanthorizons = Isbn10Urn(&quot;urn:isbn10:022661283X&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">urn:isbn10:022661283X</code></pre><h2 id="Defining-the-UrnComparisonTrait"><a class="docs-heading-anchor" href="#Defining-the-UrnComparisonTrait">Defining the <code>UrnComparisonTrait</code></a><a id="Defining-the-UrnComparisonTrait-1"></a><a class="docs-heading-anchor-permalink" href="#Defining-the-UrnComparisonTrait" title="Permalink"></a></h2><p>Subtypes of <code>Urn</code> are required to implement the <code>UrnComparisonTrait</code>, and its three functions. <code>CitableBase</code> uses the &quot;Holy trait trick&quot; to dispatch functions implementing URN comparison. </p><div class="admonition is-success"><header class="admonition-header">The Tim Holy Trait Trick</header><div class="admonition-body"><p>See <a href="https://www.juliabloggers.com/the-emergent-features-of-julialang-part-ii-traits/">this post on julia bloggers</a> for an introduction to the &quot;Tim Holy Trait Trick&quot; (THTT). .</p></div></div><p>We first define a subtype of the abstract <code>UrnComparisonTrait</code>.  It&#39;s a singleton type with no fields which we&#39;ll use as the trait value for our ISBN type.  <code>CitableBase</code> provides the <code>urncomparisontrait</code> function to determine if a class implements the <code>UrnComparisonTrait</code> so we&#39;ll import <code>urncomparisontrait</code>, and define a function returning a concrete value of <code>IsbnComparable()</code> for the type <code>Isbn10Urn</code>.</p><pre><code class="language-julia hljs">struct IsbnComparable &lt;: UrnComparisonTrait end

import CitableBase: urncomparisontrait
function urncomparisontrait(::Type{Isbn10Urn})
    IsbnComparable()
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">urncomparisontrait (generic function with 7 methods)</code></pre><p>Let&#39;s test it.</p><pre><code class="language-julia hljs">urncomparisontrait(typeof(distanthorizons))</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Main.IsbnComparable()</code></pre><p>This lets us use <code>CitableBase</code>s boolean function <code>urncomparable</code> to test specific objects.</p><pre><code class="language-julia hljs">urncomparable(distanthorizons)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><h2 id="Implementing-the-logic-of-URN-comparison"><a class="docs-heading-anchor" href="#Implementing-the-logic-of-URN-comparison">Implementing the logic of URN comparison</a><a id="Implementing-the-logic-of-URN-comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Implementing-the-logic-of-URN-comparison" title="Permalink"></a></h2><p>To fulfill the contract of the <code>UrnComparisonTrait</code>, we must implement three boolean functions for three kinds of URN comparison: <code>urnequals</code> (for <em>equality</em>), <code>urncontains</code> (for <em>containment</em>) and and <code>urnsimilar</code> (for <em>similarity</em>).  Because we have defined our type as implementing the <code>UrnComparisonTrait</code>, <code>CitableBase</code> can dispatch to functions including an <code>Isbn10Urn</code> as the first parameter.</p><h3 id="Equality"><a class="docs-heading-anchor" href="#Equality">Equality</a><a id="Equality-1"></a><a class="docs-heading-anchor-permalink" href="#Equality" title="Permalink"></a></h3><p>The <code>==</code> function of Julia Base is overridden in <code>CitableBase</code> for all subtypes of <code>Urn</code>.  This makes it trivial to implement <code>urnequals</code> once we use <code>CitableBase</code> and import <code>urnequals</code>.</p><pre><code class="language-julia hljs">import CitableBase: urnequals
function urnequals(u1::Isbn10Urn, u2::Isbn10Urn)
    u1 == u2
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">urnequals (generic function with 8 methods)</code></pre><pre><code class="language-julia hljs">dupe = distanthorizons
urnequals(distanthorizons, dupe)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><pre><code class="language-julia hljs">enumerations = Isbn10Urn(&quot;urn:isbn10:022656875X&quot;)
urnequals(distanthorizons, enumerations)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><div class="admonition is-success"><header class="admonition-header">Why do we need &#39;urnequals&#39; when we already have &#39;==&#39; ?</header><div class="admonition-body"><p>Our implementation of <code>urnequals</code> uses two parameters of the same type to compare two URNs and produce a boolean result.  In the following section, we will implement the functions of <code>UrnComparisonTrait</code> with one URN parameter and one parameter giving a citable collection.  In those implementations, we can filter the collection by comparing the URN parameter to the URNs of items in the collection.  We will reserve <code>==</code> for comparing the contents of two collections, and use <code>urnequals</code> to filter a collection&#39;s content.</p></div></div><h3 id="Containment"><a class="docs-heading-anchor" href="#Containment">Containment</a><a id="Containment-1"></a><a class="docs-heading-anchor-permalink" href="#Containment" title="Permalink"></a></h3><p>For our ISBN type, we&#39;ll define &quot;containment&quot; as true when two ISBNS belong to the same initial-digit group (<code>0</code> - <code>4</code>).  We&#39;ll use the <code>components</code> functions from <code>CitableBase</code> to extract the third part of each URN string, and compare their first characters.</p><pre><code class="language-julia hljs">import CitableBase: urncontains
function urncontains(u1::Isbn10Urn, u2::Isbn10Urn)
    initial1 = components(u1.isbn)[3][1]
    initial2 = components(u2.isbn)[3][1]

    initial1 == initial2
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">urncontains (generic function with 7 methods)</code></pre><p>Both <em>Distant Horizons</em> and <em>Enumerations</em> are in ISBN group 0.</p><pre><code class="language-julia hljs">urncontains(distanthorizons, enumerations)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>But <em>Can We Be Wrong?</em> is in ISBN group 1.</p><pre><code class="language-julia hljs">wrong = Isbn10Urn(&quot;urn:isbn10:1108922036&quot;)
urncontains(distanthorizons, wrong)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><h3 id="Similarity"><a class="docs-heading-anchor" href="#Similarity">Similarity</a><a id="Similarity-1"></a><a class="docs-heading-anchor-permalink" href="#Similarity" title="Permalink"></a></h3><p>We&#39;ll define &quot;similarity&quot; as belonging to the same language area.  In this definition, both <code>0</code> and <code>1</code> indicate English-language countries.</p><pre><code class="language-julia hljs"># True if ISBN starts with `0` or `1`
function english(urn::Isbn10Urn)
    langarea = components(urn.isbn)[3][1]
    langarea == &#39;0&#39; || langarea == &#39;1&#39;
end

import CitableBase: urnsimilar
function urnsimilar(u1::Isbn10Urn, u2::Isbn10Urn)
    initial1 = components(u1.isbn)[3][1]
    initial2 = components(u2.isbn)[3][1]

    (english(u1) &amp;&amp; english(u2)) ||  initial1 == initial2
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">urnsimilar (generic function with 7 methods)</code></pre><p>Both <em>Distant Horizons</em> and <em>Can We Be Wrong?</em> are published in English-language areas.</p><pre><code class="language-julia hljs">urnsimilar(distanthorizons, wrong)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>But they are coded for different ISBN areas.</p><pre><code class="language-julia hljs">wrong = Isbn10Urn(&quot;urn:isbn10:1108922036&quot;)
urncontains(distanthorizons, wrong)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><h2 id="Optional-methods"><a class="docs-heading-anchor" href="#Optional-methods">Optional methods</a><a id="Optional-methods-1"></a><a class="docs-heading-anchor-permalink" href="#Optional-methods" title="Permalink"></a></h2><p>The <code>CtsUrn</code> (from <code>CitableText</code>) and the <code>Cite2Urn</code> (from <code>CitableObject</code>) illustrate two optional behaviors: support for versioning of URNs, and support for subreferences.  Although our ISBN numbers don&#39;t require either of those features, we&#39;ll illustrate how they are implemented.</p><h3 id="Versioning"><a class="docs-heading-anchor" href="#Versioning">Versioning</a><a id="Versioning-1"></a><a class="docs-heading-anchor-permalink" href="#Versioning" title="Permalink"></a></h3><p>The three relevant functions are <code>supportsversion</code>, <code>addversion</code> and <code>dropversion</code>.  We&#39;ll indicate that our URN type supports versioning but for this demonstration will just pass the URN through unchanged.</p><pre><code class="language-julia hljs">import CitableBase: supportsversion
function supportsversion(u::Isbn10Urn)
    true
end

import CitableBase: addversion
function addversion(u::Isbn10Urn, versioninfo::AbstractString)
    u
end

import CitableBase: dropversion
function dropversion(u::Isbn10Urn)
    u
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">dropversion (generic function with 2 methods)</code></pre><pre><code class="language-julia hljs">supportsversion(wrong)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><pre><code class="language-julia hljs">addversion(wrong, &quot;v2&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">urn:isbn10:1108922036</code></pre><pre><code class="language-julia hljs">dropversion(wrong)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">urn:isbn10:1108922036</code></pre><h3 id="Subreferences"><a class="docs-heading-anchor" href="#Subreferences">Subreferences</a><a id="Subreferences-1"></a><a class="docs-heading-anchor-permalink" href="#Subreferences" title="Permalink"></a></h3><pre><code class="language-julia hljs">import CitableBase: supportssubref
function supportssubref(u::Isbn10Urn)
    true
end

import CitableBase: dropsubref
function dropsubref(u::Isbn10Urn)
    u
end

import CitableBase: hassubref
function hassubref(u::Isbn10Urn)
    false
end

import CitableBase: subref
function subref(u::Isbn10Urn)
    nothing
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">subref (generic function with 2 methods)</code></pre><pre><code class="language-julia hljs">supportssubref(wrong)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><pre><code class="language-julia hljs">hassubref(wrong)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><pre><code class="language-julia hljs">dropsubref(wrong)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">urn:isbn10:1108922036</code></pre><pre><code class="language-julia hljs">subref(wrong)</code></pre><h2 id="Recap:-identifiers"><a class="docs-heading-anchor" href="#Recap:-identifiers">Recap: identifiers</a><a id="Recap:-identifiers-1"></a><a class="docs-heading-anchor-permalink" href="#Recap:-identifiers" title="Permalink"></a></h2><p>On this page, we defined the <code>Isnb10Urn</code> type as a subtype of <code>Urn</code> and identified our type as implementing the <code>UrnComparisonTrait</code>.  You can test this with <code>urncomparable</code>s.</p><pre><code class="language-julia hljs">urncomparable(distanthorizons)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>We implemented the trait&#39;s required functions to compare pairs of URNs based on URN logic for equality, similarity and containment, and return boolean values.</p><p>The next page will make use of our URN type to define a citable object identified by <code>Isbn10Urn</code>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../citable/">Citable objects »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.12 on <span class="colophon-date" title="Thursday 10 February 2022 12:34">Thursday 10 February 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
